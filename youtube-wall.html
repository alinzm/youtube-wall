<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Wall</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    min-height: 100vh;
    background: linear-gradient(170deg, #0a0a0f 0%, #0f1118 40%, #0a0a0f 100%);
    color: #e0e0e0;
    font-family: 'Space Grotesk', sans-serif;
    padding: 20px 24px;
  }
  input::placeholder { color: #555; }
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

  header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px; padding-bottom: 16px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
  }
  .title-row { display: flex; align-items: center; gap: 14px; }
  .logo-box {
    width: 44px; height: 44px; border-radius: 10px;
    background: linear-gradient(135deg, #ff0050, #ff4d4d);
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; box-shadow: 0 4px 20px rgba(255,0,80,0.3);
  }
  .logo-box span { filter: grayscale(1) brightness(10); }
  h1 { font-size: 20px; font-weight: 700; letter-spacing: 0.12em; color: #fff; line-height: 1.2; }
  .subtitle {
    font-size: 12px; color: #666; font-family: 'JetBrains Mono', monospace; margin-top: 2px;
  }
  .count-badge {
    background: rgba(255,0,80,0.2); color: #ff4d6a;
    padding: 1px 6px; border-radius: 4px; font-size: 11px; font-weight: 700;
  }
  #playAllBtn {
    background: transparent; border: 1px solid rgba(0,200,100,0.3); color: #00c864;
    padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 12px;
    font-weight: 600; font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.05em; transition: all 0.2s; display: none;
  }
  #playAllBtn:hover { background: rgba(0,200,100,0.1); }
  #clearAllBtn {
    background: transparent; border: 1px solid rgba(255,77,77,0.3); color: #ff4d4d;
    padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 12px;
    font-weight: 600; font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.05em; transition: all 0.2s; display: none;
  }
  #clearAllBtn:hover { background: rgba(255,77,77,0.1); }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 14px;
  }
  .card {
    position: relative; border-radius: 12px; overflow: hidden;
    background: #111118; border: 1px solid rgba(255,255,255,0.06);
    aspect-ratio: 16/9; transition: border-color 0.3s, box-shadow 0.3s;
  }
  .card.has-video { border-color: rgba(255,0,80,0.15); }
  .card:hover { border-color: rgba(255,255,255,0.12); }
  .slot-label {
    position: absolute; top: 8px; left: 10px; font-size: 10px;
    font-family: 'JetBrains Mono', monospace; color: #333;
    font-weight: 700; z-index: 2; pointer-events: none;
  }

  .card-empty {
    display: flex; align-items: center; justify-content: center;
  }
  .empty-inner {
    display: flex; flex-direction: column; align-items: center;
    gap: 10px; padding: 20px; width: 100%;
  }
  .play-icon { font-size: 28px; color: #222; margin-bottom: 4px; }
  .hint-text {
    font-size: 10px; color: #444; font-family: 'JetBrains Mono', monospace;
    text-align: center; line-height: 1.5;
  }
  .hint-text span { color: #ff4d6a; }
  .card-input {
    width: 88%; max-width: 300px; padding: 10px 14px; border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03);
    color: #e0e0e0; font-size: 12px; font-family: 'JetBrains Mono', monospace;
    outline: none; text-align: center; transition: border-color 0.2s, background 0.2s;
    text-overflow: ellipsis;
  }
  .card-input:focus { border-color: rgba(255,0,80,0.4); }
  .card-input.error { border-color: #ff4d4d; background: rgba(255,77,77,0.08); }
  .add-btn {
    padding: 8px 24px; border-radius: 8px; border: none;
    background: linear-gradient(135deg, #ff0050, #ff4d4d); color: #fff;
    font-size: 12px; font-weight: 700; font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.08em; cursor: pointer; transition: transform 0.15s, box-shadow 0.2s;
    box-shadow: 0 2px 12px rgba(255,0,80,0.25);
  }
  .add-btn:hover { transform: scale(1.04); }
  .error-text { font-size: 11px; color: #ff4d4d; font-family: 'JetBrains Mono', monospace; display: none; }

  .card iframe {
    width: 100%; height: 100%; border: none;
  }
  .clear-btn {
    position: absolute; top: 6px; right: 8px; width: 26px; height: 26px;
    border-radius: 50%; border: none; background: rgba(0,0,0,0.7);
    color: #fff; font-size: 13px; cursor: pointer; z-index: 3;
    display: flex; align-items: center; justify-content: center;
    opacity: 0; transition: opacity 0.2s; backdrop-filter: blur(4px);
  }
  .card:hover .clear-btn { opacity: 0.8; }
  .clear-btn:hover { opacity: 1 !important; }

  footer {
    text-align: center; margin-top: 20px; font-size: 12px; color: #444;
    font-family: 'JetBrains Mono', monospace;
  }
  kbd {
    background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
    border-radius: 4px; padding: 2px 6px; font-size: 11px; color: #888;
  }
  .notice {
    background: rgba(255,170,0,0.1); border: 1px solid rgba(255,170,0,0.3);
    color: #ffaa00; padding: 12px 18px; border-radius: 10px; font-size: 13px;
    font-family: 'JetBrains Mono', monospace; text-align: center; margin-bottom: 16px;
  }
  .notice strong { color: #fff; }

  .presets {
    margin-bottom: 16px; padding: 14px 16px;
    background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06);
    border-radius: 12px;
  }
  .presets-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 10px;
  }
  .presets-title {
    font-size: 11px; font-family: 'JetBrains Mono', monospace;
    color: #666; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
  }
  .presets-actions { display: flex; gap: 8px; }
  .load-all-btn {
    background: transparent; border: 1px solid rgba(255,0,80,0.3); color: #ff4d6a;
    padding: 5px 14px; border-radius: 6px; cursor: pointer; font-size: 11px;
    font-weight: 600; font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.05em; transition: all 0.2s;
  }
  .load-all-btn:hover { background: rgba(255,0,80,0.1); }
  .presets-strip {
    display: flex; gap: 8px; overflow-x: auto; padding-bottom: 4px;
  }
  .presets-strip::-webkit-scrollbar { height: 4px; }
  .presets-strip::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
  .preset-thumb {
    flex-shrink: 0; width: 130px; height: 74px; border-radius: 8px;
    overflow: hidden; cursor: pointer; position: relative;
    border: 2px solid transparent; transition: border-color 0.2s, transform 0.15s;
  }
  .preset-thumb:hover { border-color: rgba(255,0,80,0.5); transform: scale(1.05); }
  .preset-thumb.used { opacity: 0.35; pointer-events: none; }
  .preset-thumb img {
    width: 100%; height: 100%; object-fit: cover; display: block;
  }
  .preset-thumb .preset-add-icon {
    position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
    background: rgba(0,0,0,0.4); opacity: 0; transition: opacity 0.2s;
    font-size: 22px; color: #fff;
  }
  .preset-thumb:hover .preset-add-icon { opacity: 1; }
  .preset-thumb .preset-id {
    position: absolute; bottom: 4px; right: 6px; font-size: 9px;
    font-family: 'JetBrains Mono', monospace; color: rgba(255,255,255,0.5);
    background: rgba(0,0,0,0.6); padding: 1px 5px; border-radius: 3px;
  }

  .popup-overlay {
    position: fixed; inset: 0; z-index: 100;
    background: rgba(0,0,0,0.75); backdrop-filter: blur(8px);
    display: flex; align-items: center; justify-content: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.25s ease;
  }
  .popup-overlay.active { opacity: 1; pointer-events: auto; }
  .popup-frame {
    width: 70vw; max-width: 1100px; aspect-ratio: 16/9;
    border-radius: 16px; overflow: hidden;
    border: 1px solid rgba(255,0,80,0.25);
    box-shadow: 0 8px 60px rgba(255,0,80,0.2), 0 0 120px rgba(0,0,0,0.6);
    transform: scale(0.92); transition: transform 0.25s ease;
  }
  .popup-overlay.active .popup-frame { transform: scale(1); }
  .popup-frame iframe { width: 100%; height: 100%; border: none; }
  .popup-slot-label {
    position: absolute; top: 20px; left: 24px;
    font-size: 13px; font-family: 'JetBrains Mono', monospace;
    color: rgba(255,255,255,0.4); font-weight: 700;
  }
</style>
</head>
<body>

<header>
  <div class="title-row">
    <div class="logo-box"><span>üì∫</span></div>
    <div>
      <h1>VIDEO WALL</h1>
      <p class="subtitle"><span class="count-badge" id="countBadge">0</span> / 12 slots loaded</p>
    </div>
  </div>
  <div style="display:flex;gap:8px;align-items:center;">
    <button id="playAllBtn" onclick="playAll()" style="display:none;">‚ñ∂ Play All</button>
    <button id="clearAllBtn" onclick="clearAll()">Clear All</button>
  </div>
</header>

<div class="notice" id="notice" style="display:none;">
  ‚ö†Ô∏è YouTube embeds require HTTP. If you see errors, run: <strong>python3 -m http.server 8000</strong> in this folder, then open <strong>http://localhost:8000/youtube-wall.html</strong>
</div>

<div class="presets">
  <div class="presets-header">
    <span class="presets-title">Preset Videos</span>
    <div class="presets-actions">
      <button class="load-all-btn" onclick="loadAllPresets()">Load All</button>
    </div>
  </div>
  <div class="presets-strip" id="presetsStrip"></div>
</div>

<div class="grid" id="grid"></div>

<div class="popup-overlay" id="popupOverlay" onclick="if(event.target===this)hidePopup()">
  <div class="popup-slot-label" id="popupSlotLabel"></div>
  <div class="popup-frame" id="popupFrame"></div>
</div>

<footer>
  Paste a YouTube <kbd>&lt;iframe&gt;</kbd> embed code or URL into any slot ‚Üí hit <kbd>Enter</kbd> or <kbd>Load</kbd>
</footer>

<script>
const PRESETS = [
  'hcoSaCCLrDI',
  '5qN1dRjatv8',
  'A92pqZQAsm8',
  'RgM8QLiuL2g',
  'gCNeDWCI0vo',
  'YDvsBbKfLPA',
  'bNyUyrR0PHo',
  'n7eQejkXbnM',
  '6N8_r2uwLEc',
  'L-TNmYmaAKQ',
  'bjgQzJzCZKs',
];

// Each slot stores: { src, videoId } or null
const videos = Array(12).fill(null);

function isPresetLoaded(videoId) {
  return videos.some(v => v && v.videoId === videoId);
}

function getNextEmptySlot() {
  return videos.findIndex(v => v === null);
}

function loadPreset(videoId) {
  const slot = getNextEmptySlot();
  if (slot === -1) return;
  videos[slot] = { src: `https://www.youtube.com/embed/${videoId}?rel=0`, videoId };
  render();
}

function loadAllPresets() {
  PRESETS.forEach(id => {
    if (!isPresetLoaded(id)) loadPreset(id);
  });
}

function renderPresets() {
  const strip = document.getElementById('presetsStrip');
  strip.innerHTML = '';
  PRESETS.forEach(id => {
    const thumb = document.createElement('div');
    thumb.className = 'preset-thumb' + (isPresetLoaded(id) ? ' used' : '');
    thumb.onclick = () => loadPreset(id);
    thumb.innerHTML = `
      <img src="https://img.youtube.com/vi/${id}/mqdefault.jpg" alt="${id}">
      <div class="preset-add-icon">+</div>
      <div class="preset-id">${id.slice(0, 6)}‚Ä¶</div>
    `;
    strip.appendChild(thumb);
  });
}

function extractFromIframe(text) {
  // Try to extract src from an iframe tag
  const srcMatch = text.match(/src=["']([^"']+)["']/);
  if (srcMatch) {
    const src = srcMatch[1];
    // Extract video ID from embed URL
    const idMatch = src.match(/youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/);
    return { src, videoId: idMatch ? idMatch[1] : null };
  }
  return null;
}

function extractFromUrl(url) {
  const patterns = [
    /(?:youtube\.com\/watch\?v=)([a-zA-Z0-9_-]{11})/,
    /(?:youtu\.be\/)([a-zA-Z0-9_-]{11})/,
    /(?:youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/,
    /(?:youtube\.com\/shorts\/)([a-zA-Z0-9_-]{11})/,
  ];
  for (const p of patterns) {
    const m = url.match(p);
    if (m) return { src: `https://www.youtube.com/embed/${m[1]}?rel=0`, videoId: m[1] };
  }
  return null;
}

function parseInput(text) {
  text = text.trim();
  // First try iframe embed code
  const iframeResult = extractFromIframe(text);
  if (iframeResult) return iframeResult;
  // Then try plain URL
  const urlResult = extractFromUrl(text);
  if (urlResult) return urlResult;
  return null;
}

function updateCount() {
  const c = videos.filter(Boolean).length;
  document.getElementById('countBadge').textContent = c;
  document.getElementById('clearAllBtn').style.display = c > 0 ? 'block' : 'none';
  document.getElementById('playAllBtn').style.display = c > 0 ? 'block' : 'none';
}

function playAll() {
  videos.forEach((vid, i) => {
    if (!vid) return;
    const card = document.getElementById('card-' + i);
    const iframe = card.querySelector('iframe');
    if (iframe) {
      const sep = vid.src.includes('?') ? '&' : '?';
      iframe.src = vid.src + sep + 'autoplay=1&mute=1';
    }
  });
}

function clearAll() {
  videos.fill(null);
  render();
}

function loadVideo(index) {
  const input = document.getElementById('input-' + index);
  const errorEl = document.getElementById('error-' + index);
  const parsed = parseInput(input.value);
  if (parsed) {
    videos[index] = parsed;
    input.classList.remove('error');
    errorEl.style.display = 'none';
    render();
  } else {
    input.classList.add('error');
    errorEl.style.display = 'block';
  }
}

function clearVideo(index) {
  videos[index] = null;
  render();
}

let hoverTimer = null;
let activePopupIndex = -1;

function showPopup(index) {
  const vid = videos[index];
  if (!vid) return;
  activePopupIndex = index;
  const overlay = document.getElementById('popupOverlay');
  const frame = document.getElementById('popupFrame');
  const label = document.getElementById('popupSlotLabel');
  label.textContent = 'SLOT ' + (index + 1);
  frame.innerHTML = `<iframe src="${vid.src}&autoplay=1" title="Video ${index + 1}" frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
  overlay.classList.add('active');
}

function hidePopup() {
  clearTimeout(hoverTimer);
  hoverTimer = null;
  activePopupIndex = -1;
  const overlay = document.getElementById('popupOverlay');
  overlay.classList.remove('active');
  document.getElementById('popupFrame').innerHTML = '';
}


function attachHoverListeners() {
  videos.forEach((vid, i) => {
    if (!vid) return;
    const card = document.getElementById('card-' + i);
    card.addEventListener('mouseenter', () => {
      if (activePopupIndex === i) return;
      clearTimeout(hoverTimer);
      hoverTimer = setTimeout(() => showPopup(i), 400);
    });
    card.addEventListener('mouseleave', () => {
      clearTimeout(hoverTimer);
      hoverTimer = null;
    });
  });
}

function render() {
  const grid = document.getElementById('grid');
  grid.innerHTML = '';

  videos.forEach((vid, i) => {
    const card = document.createElement('div');
    card.className = 'card' + (vid ? ' has-video' : ' card-empty');
    card.id = 'card-' + i;

    if (vid) {
      card.innerHTML = `
        <div class="slot-label">${i + 1}</div>
        <iframe
          src="${vid.src}"
          title="Video ${i + 1}"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          referrerpolicy="strict-origin-when-cross-origin"
          allowfullscreen>
        </iframe>
        <button class="clear-btn" onclick="clearVideo(${i})" title="Remove">‚úï</button>
      `;
    } else {
      card.innerHTML = `
        <div class="slot-label">${i + 1}</div>
        <div class="empty-inner">
          <div class="play-icon">‚ñ∂</div>
          <input type="text" class="card-input" id="input-${i}"
            placeholder="Paste iframe embed or YouTube URL‚Ä¶"
            onkeydown="if(event.key==='Enter')loadVideo(${i})"
            oninput="this.classList.remove('error');document.getElementById('error-${i}').style.display='none'">
          <button class="add-btn" onclick="loadVideo(${i})">Load</button>
          <div class="hint-text">Accepts <span>&lt;iframe&gt;</span> embed codes or YouTube links</div>
          <div class="error-text" id="error-${i}">Could not parse ‚Äî try a YouTube URL or iframe code</div>
        </div>
      `;
    }

    grid.appendChild(card);
  });

  updateCount();
  renderPresets();
  attachHoverListeners();
}

render();

// Detect sandboxed iframe or file:// protocol and show warning
try {
  if (window.self !== window.top || window.frameElement || window.location.protocol === 'file:') {
    document.getElementById('notice').style.display = 'block';
  }
} catch(e) {
  document.getElementById('notice').style.display = 'block';
}
</script>
</body>
</html>
